<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · GRASS</title><meta name="title" content="Advanced Usage · GRASS"/><meta property="og:title" content="Advanced Usage · GRASS"/><meta property="twitter:title" content="Advanced Usage · GRASS"/><meta name="description" content="Documentation for GRASS."/><meta property="og:description" content="Documentation for GRASS."/><meta property="twitter:description" content="Documentation for GRASS."/><meta property="og:url" content="https://palumbom.github.io/GRASS/examples/advanced/"/><meta property="twitter:url" content="https://palumbom.github.io/GRASS/examples/advanced/"/><link rel="canonical" href="https://palumbom.github.io/GRASS/examples/advanced/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GRASS</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../basic/">Basic Usage</a></li><li class="is-active"><a class="tocitem" href>Advanced Usage</a><ul class="internal"><li><a class="tocitem" href="#Accessing-the-Input-Data"><span>Accessing the Input Data</span></a></li><li><a class="tocitem" href="#Measuring-a-Line-Bisector"><span>Measuring a Line Bisector</span></a></li></ul></li></ul></li><li><span class="tocitem">Input Data</span><ul><li><a class="tocitem" href="../../input_data/description/">Input Data Description</a></li><li><a class="tocitem" href="../../input_data/manipulation/">Input Data Manipulation</a></li></ul></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../longlist/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>Advanced Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/palumbom/GRASS" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/palumbom/GRASS/blob/main/docs/src/examples/advanced.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Usage"><a class="docs-heading-anchor" href="#Advanced-Usage">Advanced Usage</a><a id="Advanced-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Usage" title="Permalink"></a></h1><p>Examples of more advanced usage of GRASS can be found in the <a href="https://github.com/palumbom/GRASS/tree/main/figures">figures/ directory</a>. These scripts were used to generate the figures that can be found in the GRASS paper. For clarity, a few specific advanced use cases are highlighted below.</p><h2 id="Accessing-the-Input-Data"><a class="docs-heading-anchor" href="#Accessing-the-Input-Data">Accessing the Input Data</a><a id="Accessing-the-Input-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-the-Input-Data" title="Permalink"></a></h2><p>The &quot;input data&quot; described in the GRASS paper can be accessed as follows:</p><pre><code class="language-julia hljs">using GRASS

# get input data
input_data = GRASS.SolarData()</code></pre><p>The  <code>input_data</code> variable is an instance of the <code>SolarData</code> composite type. It contains the bisector and width measurements for all epochs of the input data. The data are stored in dictionaries keyed by tuples of symbols representing a location on the disk. Accessing the data at a location on the disk is as simple as specifying the appropriate key.</p><pre><code class="language-julia hljs"># get bisector data at disk center
wav = input_data.wav[(:c, :mu10)]
bis = input_data.bis[(:c, :mu10)]</code></pre><p>In the above code, <code>wav</code> is a 2D array of wavelengths. Each column contains a measurement of wavelength corresponding to the intensity measured in the corresponding column of <code>bis</code> at a given time. Plotting a bisector in matplotlib simply entails slicing out the desired column.</p><pre><code class="language-julia hljs">plt.plot(wav[:,1], bis[:,1])
plt.show()</code></pre><h2 id="Measuring-a-Line-Bisector"><a class="docs-heading-anchor" href="#Measuring-a-Line-Bisector">Measuring a Line Bisector</a><a id="Measuring-a-Line-Bisector-1"></a><a class="docs-heading-anchor-permalink" href="#Measuring-a-Line-Bisector" title="Permalink"></a></h2><p>GRASS can also compute bisectors for absorption lines or CCF profiles. A detailed example of this can be seen in <a href="https://github.com/palumbom/GRASS/blob/main/figures/fig3.jl">the code for Figure 3</a>. A streamlined version is presented below. First, GRASS is used to generate some synthetic spectra (exactly as in the <a href="https://palumbom.github.io/GRASS/dev/examples/examples/#Generating-Synthetic-Spectra">basic use example</a>):</p><pre><code class="language-julia hljs">using GRASS

# parameters for lines in the spectra
lines = [5434.5]     # array of line centers in angstroms
depths = [0.75]      # continuum-normalized depth of lines
resolution = 7e5     # spectral resolution of the output spectra
spec = SpecParams(lines=lines, depths=depths, resolution=resolution)

# specify number of epochs (default 15-second spacing)
disk = DiskParams(Nt=25)

# synthesize the spectra
wavelengths, flux = synthesize_spectra(spec, disk)</code></pre><p>Then, we call the <code>GRASS.measure_bisector</code> function:</p><pre><code class="language-julia hljs">wav_synth, bis_synth = GRASS.measure_bisector(wavelengths, flux, interpolate=true, top=0.9)</code></pre><p>Two methods for calculating bisectors are implemented. By default, GRASS will attempt to interpolate the absorption line profile onto a uniform grid of flux values. Then the bisector is calculated as the average wavelength value on the left and right wings of the absorption line. Interpolation usually provides cleaner results, but it will fail if the line profile is sufficiently noisy. In this case, if <code>interpolation=false</code>, GRASS will use an iterative approach that is more stable, but less precise.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../basic/">« Basic Usage</a><a class="docs-footer-nextpage" href="../../input_data/description/">Input Data Description »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Saturday 13 April 2024 02:58">Saturday 13 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
